h1. Dokumentation für oddb2xml --calc

Wenn man oddb2xml mit der Option @--calc@ aufruft, wird eine Datei @oddb_calc.xml@ erstellt, welche aufgrund diverser offener Datenquellen, (u.a. "Excel-Version Zugelassene Verpackungen":https://www.swissmedic.ch/arzneimittel/00156/00221/00222/00230/index.html?lang=de ) die Zusammensetzung aller in der Schweiz öffentlich zugelassener Medikamente im XML-Format erstellt.

h2. Ziel

Die Swissmedic verpackt in der Excel-Datei für die Packungsbsbeschreibung in den Spalte Q @Zusammensetzung@, eine Menge an Informationen, aus welchen Bestandteilen ein Medikament besteht. Zu einem grossen Teil folgt dies einer Syntax, für welche keine öffentlich zugängliche Dokumention zu bestehen scheint. Deshalb wurde für das Projekt ODDB.org anfangs 2015 beschlossen, die Analyse dieses Feldes von einem auf (was SW-Ingenieure) regulären Ausdrücken basierenden Algorithum auf einen echten Parser umzustellen.

In diesem Dokument versuchen wir die dabei erkannten Elemente kurz zu dokumentieren und Grenzfälle und Entscheide anhand von Beispielen (mit IKSNR und Name identifiert) zu begründen.


h2. Syntax

Die Syntax wird in einer Datei "compositions_syntax":https://raw.githubusercontent.com/ngiger/oddb2xml/master/lib/oddb2xml/compositions_syntax.rb beschrieben.

- ratio := Falls eine Zeile in der Zusammensetzung so was wie @ratio: 1:10@ oder @ratio: 1:1.5-2.4@ enthält, wird das Feld "more_info" entsprechend gesetzt.

- Namen mit Zahlen := @Glyceroli Monostearas 33-45@ ist eine Name und nicht Glyceroli Monostearas von 33 bis 45.

- Dosis := Häufig einfach, z.B. @5 mg@. Komplizierte Ausdrücke wie @2*10^9 CFU@, @9 g/L 5 ml@, @40-55@, @75/25@, @150 U.I. hFSH et 150 U.I. hLH@ oder @6.0 +/-1.2 µg/0.5 ml@ findet man auch.

- chemical_substance := In der XML-Datei findet man die Substance welche im Swissmedic-Jargon via @corresp@ (u.ä) als eigentlicher Wirkstoff referenziert wird. 

h2. Gebrauchte Abkürzungen und Schlüsselworte

- DER :=  DrugEthanol Ratio
- Diluens := tbd
- Pulver := tbd
- Solutio reconstituta := tbd
- Solvens (i.m.) := tbd
- Solvens (i.v.) := tbd
- Solvens := tbd
- ad emulsionem := tbd
- ad globulos := zu den Vaginalkugeln
- ad pulverem := zum Pulver hinzufügen
- ad solutionem := füge zur Lösung hinzu
- ad suspensionem := tbd
- aether q.s. := genügend Äther/Aether/Ether
- ana partes := zu gleichen Teilen
- antiox. := tbd
- aqua := tbd
- aqua ad := tbd
- aqua ad iniectabilia := Wasser zu Injektionszwecken
- aqua ad iniectabilia := tbd
- aqua ad iniectabilia q.s. ad solutionem := genügend steriles Wasser zur Lösung/zum Lösen
- aqua ad iniectabilia q.s. ad solutionem := tbd
- aqua ad iniectabilia q.s. ad solutionem pro := tbd
- aqua ad solutionem pro := tbd
- aqua q.s. := tbd
- aqua q.s. ad := genügend Wasser zu
- aqua q.s. ad := tbd
- aqua q.s. ad emulsionem pro := tbd
- aqua q.s. ad gelatume pro := tbd
- aqua q.s. ad solutionem pro := tbd
- aqua q.s. ad suspensionem pro := tbd
- aquos := tbd
- arom. := tbd
- ca. := tbd
- color. := tbd
- conserv. := tbd
- corresp. := tbd
- corresp. ca. := tbd
- deklar. := tbd
- doses := tbd
- doses pro vase := tbd
- et alia := es gibt noch andere Substanzen. Beispiel 62504 Olanzapin Sandoz Solufilm 20 mg
- et oder , := trennen Substanzen. Beispiel 29555 NaCl 11,7 % B. Braun, Zusatzampullen zu Infusionslösungen
- excipiens := Füllmittel
- excipiens ad emulsionem pro := tbd
- excipiens ad pulverem pro := tbd
- excipiens ad solutionem pro := tbd
- excipiens pro compresso := tbd
- excipiens pro compresso obducto := tbd
- excipiens pro praeparatione := tbd
- mineralia := tbd
- pro capsula := tbd
- pro charta := pro Pulver Briefchen
- pro compresso := pro Tablette
- pro compresso obducto := pro Dragée
- pro dosi := tbd
- pro praeparatione := pro Präparat
- pro vase := tbd
- pro vitro := tbd
- q.s. := quantum satis (genügend, meist ohne Limitenangabe)
- q.s. ad := quatum satis ad (genügend für/zu/zum)
- q.s. ad pulverem pro := tbd
- q.s. pro praeparatione := genügend für Präparat
- ratio := tbd
- residui := tbd
- saccharum ad := Zucker hinzufügen zu
- solvens (i.v.) aqua ad iniectabilia := Lösungsmittel (intravenös) Wasser zu Injektionszwecken
- spag. := tbd
- spec. := tbd
- spp. := tbd
- ssp. := tbd
- ut := vorgehende Substanz wird via nachstehend aufgeführte Salze(e) aufgenommen. Beispiel 54749 Supradyn Vital 50+.
- ut alia := tbd
- ut aqua ad iniectabilia q.s. ad emulsionem pro := tbd
- var. := tbd

h2. Vorschlag für Bereinigung

* SwissmedicErrorHandler
* Corresp: als Label für Bestandteile immer Gross schreiben
* corresp. für zugehörende Substanz, immer klein schreiben
* Namen von Präparaten und Substanzen, welche Klammern, Anführungszeichen, etc enthalten, mit einfache Anführungszeichen umgeben, z.B. @2,2'-methylen-bis(6-tert.-butyl-4-methyl-phenolum)@ -> @"2,2'-methylen-bis(6-tert.-butyl-4-methyl-phenolum)"@. Dito für Namen, welche Zahlen enthalten wie @Macrogolum 3350@
* @<@ durch @max.@ ersetzen (1 Mal)
* @mind.@ durch @min.@ ersetzen, @min.@ kommt viel häufiger vor
* Alle Bereiche wie @2.4-60 GBq@  durch @2.4-60 GBq@ ersetzen, damit das maschinelle Parsen einfacher wird. Siehe auch Bemerkung über Dosis.

